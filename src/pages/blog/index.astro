---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf(),
);
const withBase = (path: string) => `${import.meta.env.BASE_URL}${path.replace(/^\/+/g, '')}`;
const blogPageUrl = (slug: string) => withBase(`blog/${slug}/`);
const homeUrl = import.meta.env.BASE_URL ?? '/';
---

<Layout title="Galaxy Insights" description="Regulatory, logistics, and quality insights from Galaxy and Profarma Group." showGlobalNav>
	<main class="mx-auto max-w-5xl px-6 py-16 text-[var(--slate)]">
		<a href={homeUrl} class="text-sm text-[var(--accent)]">‚Üê Back to home</a>
		<section class="mb-12 text-center">
			<p class="text-sm uppercase tracking-[0.4em] text-[var(--muted)]">Galaxy Blog</p>
			<h1 class="mt-4 text-4xl font-semibold text-[var(--slate)]">Regulatory clarity. Operational precision.</h1>
			<p class="mt-3 text-lg text-[var(--muted)]">
				Stories from the teams accelerating pharmaceutical access throughout Albania.
			</p>
		</section>
		<div class="grid gap-6">
			{posts.map((post) => {
				const heroSrc = post.data.heroImage ? withBase(post.data.heroImage.src) : undefined;
					return (
						<a
							href={blogPageUrl(post.slug)}
							key={post.id}
							class="glow-card flex flex-col overflow-hidden rounded-3xl border border-white/5 transition hover:border-white/30"
						>
					{heroSrc && (
						<img src={heroSrc} alt={post.data.heroImage?.alt} class="h-64 w-full object-cover" loading="lazy" />
					)}
					<div class="flex flex-col gap-4 p-6 text-left">
						<p class="text-xs uppercase tracking-[0.4em] text-[var(--muted)]">
							{post.data.publishDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
						</p>
						<h2 class="text-2xl font-semibold text-[var(--slate)]">{post.data.title}</h2>
						<p class="text-base text-[var(--muted)]">{post.data.description}</p>
							<div class="flex flex-wrap gap-2 text-xs text-[var(--muted)]">
								{post.data.tags?.map((tag) => (
									<span class="rounded-full border border-black/5 px-3 py-1" key={tag}>#{tag}</span>
								))}
							</div>
					</div>
						</a>
					);
			})}
		</div>
	</main>
</Layout>
